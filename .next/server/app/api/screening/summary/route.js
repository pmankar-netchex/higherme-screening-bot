"use strict";(()=>{var e={};e.id=55,e.ids=[55],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2048:e=>{e.exports=require("fs")},5315:e=>{e.exports=require("path")},7459:(e,t,n)=>{n.r(t),n.d(t,{originalPathname:()=>m,patchFetch:()=>y,requestAsyncStorage:()=>f,routeModule:()=>p,serverHooks:()=>g,staticGenerationAsyncStorage:()=>S});var r={};n.r(r),n.d(r,{POST:()=>d});var i=n(9303),a=n(8716),o=n(670),s=n(7070),c=n(2903),u=n(5709),l=n(6332);async function d(e){try{let{screeningId:t,summary:n}=await e.json();if(!t||!n)return s.NextResponse.json({error:"Missing required fields"},{status:400});let r=(0,c.fp)(t,n);if(!r)return s.NextResponse.json({error:"Screening not found"},{status:404});let i={callDuration:r.duration||0,transcript:r.transcript,audioUrl:r.audioUrl,evaluations:{experience:{score:n.experience?.highlights?.length?"Good":"Average",notes:n.experience?.evaluation||""},availability:{morningShift:n.availability?.morning||!1,eveningShift:n.availability?.evening||!1,weekendAvailable:n.availability?.weekends||!1,transportation:n.transportation?.hasReliableTransportation||!1,notes:n.availability?.notes||""},softSkills:{score:n.softSkills?.highlights?.length?"Good":"Average",notes:n.softSkills?.evaluation||""}},roleSpecificAnswers:{"Role-specific evaluation":n.roleSpecific?.evaluation||""},overallSummary:`${n.experience?.evaluation||""} ${n.softSkills?.evaluation||""}`.trim(),recommendedNextSteps:n.roleSpecific?.strengths?.length>n.roleSpecific?.areas_of_improvement?.length?"Recommended for further consideration":"Review additional qualifications",completedAt:r.completedAt||new Date().toISOString(),overallScore:7.5,recommendation:"maybe",aiSummary:JSON.stringify(n),strengths:n.roleSpecific?.strengths||[],concerns:n.roleSpecific?.areas_of_improvement||[]},a=r.candidateId;a&&(0,u.nf)(a,i,r.id);let o=r.applicationId;return o&&(0,l.kP)(o,"screening_completed","screening_call_completed","AI screening completed successfully","system"),s.NextResponse.json(r)}catch(e){return console.error("Error updating screening summary:",e),s.NextResponse.json({error:"Failed to update screening summary"},{status:500})}}let p=new i.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/screening/summary/route",pathname:"/api/screening/summary",filename:"route",bundlePath:"app/api/screening/summary/route"},resolvedPagePath:"/Users/pranavmankar/Documents/Workspace/Vapi demo/app/api/screening/summary/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:f,staticGenerationAsyncStorage:S,serverHooks:g}=p,m="/api/screening/summary/route";function y(){return(0,o.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:S})}},6332:(e,t,n)=>{n.d(t,{Jv:()=>f,PY:()=>m,Rl:()=>S,W3:()=>g,kP:()=>p});var r=n(2048),i=n.n(r),a=n(5315),o=n.n(a);let s=o().join(process.cwd(),"data"),c=o().join(s,"applications.json");function u(){i().existsSync(s)||i().mkdirSync(s,{recursive:!0})}function l(){if(u(),!i().existsSync(c))return i().writeFileSync(c,JSON.stringify([])),[];try{let e=i().readFileSync(c,"utf-8");return JSON.parse(e)}catch(e){return console.error("Error reading applications file:",e),[]}}function d(e){try{u(),i().writeFileSync(c,JSON.stringify(e,null,2))}catch(e){throw console.error("Error writing applications file:",e),e}}function p(e,t,n,r,i="system"){let a=l(),o=a.findIndex(t=>t.id===e);if(-1===o)return null;let s=a[o],c={step:n||s.currentStep||"unknown",status:"completed",timestamp:new Date().toISOString(),notes:r,completedBy:i,performedBy:i};return a[o]={...s,status:t,currentStep:n||s.currentStep,timeline:[...s.timeline,c],updatedAt:new Date().toISOString()},d(a),a[o]}function f(e){return l().find(t=>t.id===e)||null}function S(){return l()}function g(e){let t=l(),n={...e,id:`app-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return t.push(n),d(t),n}function m(e){return l().filter(t=>t.candidateId===e)}},5709:(e,t,n)=>{n.d(t,{Zb:()=>f,l0:()=>g,m$:()=>S,nf:()=>p,og:()=>m});var r=n(2048),i=n.n(r),a=n(5315),o=n.n(a);let s=o().join(process.cwd(),"data"),c=o().join(s,"candidates.json");function u(){i().existsSync(s)||i().mkdirSync(s,{recursive:!0})}function l(){if(u(),!i().existsSync(c))return i().writeFileSync(c,JSON.stringify([])),[];try{let e=i().readFileSync(c,"utf-8");return JSON.parse(e)}catch(e){return console.error("Error reading candidates file:",e),[]}}function d(e){try{u(),i().writeFileSync(c,JSON.stringify(e,null,2))}catch(e){throw console.error("Error writing candidates file:",e),e}}function p(e,t,n){let r=l(),i=r.findIndex(t=>t.id===e);return -1===i?(console.error(`Candidate with ID ${e} not found`),null):(r[i]={...r[i],screeningSummary:t,screeningId:n,updatedAt:new Date().toISOString()},d(r),r[i])}function f(e){return l().find(t=>t.id===e)||null}function S(){return l()}function g(e){let t=l(),n={id:`candidate-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),...e};return t.push(n),d(t),n}function m(e,t){let n=l(),r=n.findIndex(t=>t.id===e);return -1===r?null:(n[r]={...n[r],...t,updatedAt:new Date().toISOString()},d(n),n[r])}},2903:(e,t,n)=>{n.d(t,{$s:()=>y,K6:()=>S,fT:()=>p,fp:()=>f,mM:()=>m,z4:()=>g});var r=n(2048),i=n.n(r),a=n(5315),o=n.n(a);let s=o().join(process.cwd(),"data"),c=o().join(s,"screenings.json");function u(){i().existsSync(s)||i().mkdirSync(s,{recursive:!0})}function l(){if(u(),!i().existsSync(c))return i().writeFileSync(c,JSON.stringify([])),[];try{let e=i().readFileSync(c,"utf-8");return JSON.parse(e)}catch(e){return console.error("Error reading screenings file:",e),[]}}function d(e){try{u(),i().writeFileSync(c,JSON.stringify(e,null,2))}catch(e){throw console.error("Error writing screenings file:",e),e}}function p(e,t,n={}){let r=l(),i=r.findIndex(t=>t.id===e);if(-1===i)return null;if(r[i]={...r[i],status:t,...n,updatedAt:new Date().toISOString()},"completed"===t&&"completed"!==r[i].status&&(r[i].completedAt=new Date().toISOString(),r[i].startedAt)){let e=new Date(r[i].startedAt).getTime(),t=new Date(r[i].completedAt).getTime();r[i].duration=Math.round((t-e)/1e3)}return"in_progress"===t&&"in_progress"!==r[i].status&&(r[i].startedAt=new Date().toISOString()),d(r),r[i]}function f(e,t){let n=l(),r=n.findIndex(t=>t.id===e);return -1===r?null:(n[r]={...n[r],summary:t,updatedAt:new Date().toISOString()},d(n),n[r])}function S(){return l()}function g(e,t,n,r={}){let i=l(),a=`screening_${Date.now()}`,o=new Date().toISOString(),s={id:a,applicationId:e,candidateId:t,jobId:n,status:"scheduled",scheduledAt:o,createdAt:o,updatedAt:o,...r};return i.push(s),d(i),s}function m(e,t){let n=l(),r=n.findIndex(t=>t.id===e);if(-1===r)return null;if(n[r]={...n[r],...t,updatedAt:new Date().toISOString()},t.status){if("completed"===t.status&&"completed"!==n[r].status&&(n[r].completedAt=new Date().toISOString(),n[r].startedAt)){let e=new Date(n[r].startedAt).getTime(),t=new Date(n[r].completedAt).getTime();n[r].duration=Math.round((t-e)/1e3)}"in_progress"===t.status&&"in_progress"!==n[r].status&&(n[r].startedAt=new Date().toISOString())}return d(n),n[r]}function y(e){let t=l();return e.candidateId&&(t=t.filter(t=>t.candidateId===e.candidateId)),e.jobId&&(t=t.filter(t=>t.jobId===e.jobId)),e.applicationId&&(t=t.filter(t=>t.applicationId===e.applicationId)),e.status&&(t=t.filter(t=>t.status===e.status)),t}}};var t=require("../../../../webpack-runtime.js");t.C(e);var n=e=>t(t.s=e),r=t.X(0,[276,972],()=>n(7459));module.exports=r})();