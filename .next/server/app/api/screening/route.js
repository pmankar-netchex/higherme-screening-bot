"use strict";(()=>{var e={};e.id=777,e.ids=[777],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2048:e=>{e.exports=require("fs")},5315:e=>{e.exports=require("path")},777:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>S,patchFetch:()=>j,requestAsyncStorage:()=>f,routeModule:()=>g,serverHooks:()=>I,staticGenerationAsyncStorage:()=>m});var n={};r.r(n),r.d(n,{GET:()=>u,PATCH:()=>l,POST:()=>c,PUT:()=>p});var s=r(9303),i=r(8716),o=r(670),a=r(7070),d=r(2903);async function u(e){try{let{searchParams:t}=new URL(e.url),r=t.get("candidateId"),n=t.get("jobId"),s=t.get("applicationId"),i=t.get("status");if(!r&&!n&&!s&&!i){let e=(0,d.K6)();return a.NextResponse.json(e)}let o=(0,d.$s)({candidateId:r||void 0,jobId:n||void 0,applicationId:s||void 0,status:i||void 0});return a.NextResponse.json(o)}catch(e){return console.error("Error fetching screenings:",e),a.NextResponse.json({error:"Failed to fetch screenings"},{status:500})}}async function c(e){try{let t=await e.json(),{applicationId:r,candidateId:n,jobId:s}=t;if(!r||!n||!s)return a.NextResponse.json({error:"Missing required fields: applicationId, candidateId, jobId"},{status:400});let{applicationId:i,candidateId:o,jobId:u,...c}=t,p=(0,d.z4)(r,n,s,c);return a.NextResponse.json(p,{status:201})}catch(e){return console.error("Error creating screening:",e),a.NextResponse.json({error:"Failed to create screening record"},{status:500})}}async function p(e,{params:t}){try{let r=t.id,n=await e.json(),s=(0,d.mM)(r,n);if(!s)return a.NextResponse.json({error:"Screening not found"},{status:404});return a.NextResponse.json(s)}catch(e){return console.error("Error updating screening:",e),a.NextResponse.json({error:"Failed to update screening record"},{status:500})}}async function l(e,{params:t}){try{let r=t.id,n=await e.json();if(!n.summary)return a.NextResponse.json({error:"Summary is required"},{status:400});let s=(0,d.mM)(r,{summary:n.summary});if(!s)return a.NextResponse.json({error:"Screening not found"},{status:404});return a.NextResponse.json(s)}catch(e){return console.error("Error updating screening summary:",e),a.NextResponse.json({error:"Failed to update screening summary"},{status:500})}}let g=new s.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/screening/route",pathname:"/api/screening",filename:"route",bundlePath:"app/api/screening/route"},resolvedPagePath:"/Users/pranavmankar/Documents/Workspace/Vapi demo/app/api/screening/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:f,staticGenerationAsyncStorage:m,serverHooks:I}=g,S="/api/screening/route";function j(){return(0,o.patchFetch)({serverHooks:I,staticGenerationAsyncStorage:m})}},2903:(e,t,r)=>{r.d(t,{$s:()=>S,K6:()=>f,fT:()=>l,fp:()=>g,mM:()=>I,z4:()=>m});var n=r(2048),s=r.n(n),i=r(5315),o=r.n(i);let a=o().join(process.cwd(),"data"),d=o().join(a,"screenings.json");function u(){s().existsSync(a)||s().mkdirSync(a,{recursive:!0})}function c(){if(u(),!s().existsSync(d))return s().writeFileSync(d,JSON.stringify([])),[];try{let e=s().readFileSync(d,"utf-8");return JSON.parse(e)}catch(e){return console.error("Error reading screenings file:",e),[]}}function p(e){try{u(),s().writeFileSync(d,JSON.stringify(e,null,2))}catch(e){throw console.error("Error writing screenings file:",e),e}}function l(e,t,r={}){let n=c(),s=n.findIndex(t=>t.id===e);if(-1===s)return null;if(n[s]={...n[s],status:t,...r,updatedAt:new Date().toISOString()},"completed"===t&&"completed"!==n[s].status&&(n[s].completedAt=new Date().toISOString(),n[s].startedAt)){let e=new Date(n[s].startedAt).getTime(),t=new Date(n[s].completedAt).getTime();n[s].duration=Math.round((t-e)/1e3)}return"in_progress"===t&&"in_progress"!==n[s].status&&(n[s].startedAt=new Date().toISOString()),p(n),n[s]}function g(e,t){let r=c(),n=r.findIndex(t=>t.id===e);return -1===n?null:(r[n]={...r[n],summary:t,updatedAt:new Date().toISOString()},p(r),r[n])}function f(){return c()}function m(e,t,r,n={}){let s=c(),i=`screening_${Date.now()}`,o=new Date().toISOString(),a={id:i,applicationId:e,candidateId:t,jobId:r,status:"scheduled",scheduledAt:o,createdAt:o,updatedAt:o,...n};return s.push(a),p(s),a}function I(e,t){let r=c(),n=r.findIndex(t=>t.id===e);if(-1===n)return null;if(r[n]={...r[n],...t,updatedAt:new Date().toISOString()},t.status){if("completed"===t.status&&"completed"!==r[n].status&&(r[n].completedAt=new Date().toISOString(),r[n].startedAt)){let e=new Date(r[n].startedAt).getTime(),t=new Date(r[n].completedAt).getTime();r[n].duration=Math.round((t-e)/1e3)}"in_progress"===t.status&&"in_progress"!==r[n].status&&(r[n].startedAt=new Date().toISOString())}return p(r),r[n]}function S(e){let t=c();return e.candidateId&&(t=t.filter(t=>t.candidateId===e.candidateId)),e.jobId&&(t=t.filter(t=>t.jobId===e.jobId)),e.applicationId&&(t=t.filter(t=>t.applicationId===e.applicationId)),e.status&&(t=t.filter(t=>t.status===e.status)),t}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[276,972],()=>r(777));module.exports=n})();